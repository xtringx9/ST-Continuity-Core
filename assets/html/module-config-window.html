<!-- 模块配置侧边栏HTML -->
<div id="continuity-module-config-window">
    <div class="window-header">
        <h2>Continuity 配置面板</h2>
        <button id="continuity-window-close" class="close-btn">✕</button>
    </div>

    <div class="info-section">
        <p><strong>配置说明：</strong>在此页面可自定义模块，每个模块可设置名称、变量和变量解释。</p>
        <div class="example">
            <p>模块格式：[模块名|变量1:值1|变量2:值2...]</p>
            <p>示例：[seed|id:1|desc:伏笔描述|status:已植入]</p>
        </div>
    </div>

    <div class="custom-modules-container">
        <div class="section-title">
            <h3>自定义模块</h3>
            <div class="header-actions">
                <button id="preview-prompt-btn" class="btn-small">预览提示词</button>
                <button id="import-config-btn" class="btn-small">导入JSON</button>
                <button id="export-config-btn" class="btn-small">导出JSON</button>
                <button id="add-module-btn" class="btn-small">
                    <span>+</span> 添加模块
                </button>
            </div>
        </div>

        <!-- 模块模板（默认隐藏） -->
        <div class="module-template" style="display: none;">
            <div class="module-item">
                <div class="module-header">
                    <div class="module-name-group">
                        <span class="module-order-number"></span>
                        <label>模块名称</label>
                        <input type="text" class="module-name" placeholder="输入模块名称">
                    </div>
                    <div class="module-actions">
                        <button class="btn-small toggle-variables"><span class="arrow">▶</span><span
                                class="text">展开变量</span><span class="variable-count">(0)</span></button>
                        <button class="btn-small move-module-up" title="上移模块">▲</button>
                        <button class="btn-small move-module-down" title="下移模块">▼</button>
                        <button class="btn-small add-variable">+ 添加变量</button>
                        <button class="btn-small remove-module">- 删除模块</button>
                    </div>
                </div>

                <div class="variables-container-wrapper">
                    <div class="variables-container">
                        <!-- 变量模板 -->
                        <div class="variable-template" style="display: none;">
                            <div class="variable-item">
                                <div class="variable-name-group">
                                    <label>变量名</label>
                                    <input type="text" class="variable-name" placeholder="变量名">
                                </div>
                                <div class="variable-desc-group">
                                    <label>变量解释</label>
                                    <input type="text" class="variable-desc" placeholder="变量含义说明">
                                </div>
                                <div class="variable-actions">
                                    <button class="btn-small remove-variable">-</button>
                                </div>
                            </div>
                        </div>

                        <!-- 默认变量 -->
                        <div class="variable-item">
                            <div class="variable-name-group">
                                <label>变量名</label>
                                <input type="text" class="variable-name" placeholder="变量名">
                            </div>
                            <div class="variable-desc-group">
                                <label>变量解释</label>
                                <input type="text" class="variable-desc" placeholder="变量含义说明">
                            </div>
                            <div class="variable-actions">
                                <button class="btn-small remove-variable">-</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="module-prompt">
                    <label>模块提示词</label>
                    <textarea class="module-prompt-input" placeholder="输入模块提示词，用于指导模型如何使用此模块"></textarea>
                </div>

                <div class="module-preview">
                    <label>模块格式预览</label>
                    <input type="text" class="module-preview-text" readonly placeholder="[模块名|变量1:值1|变量2:值2...]" />
                </div>
            </div>
        </div>


    </div>

    <div class="window-actions">
        <button id="module-cancel-btn">取消</button>
        <button id="module-save-btn">保存配置</button>
    </div>
</div>

<!-- 提示词预览窗口 -->
<div id="continuity-prompt-preview-window" class="continuity-modal-window">
    <div class="window-header">
        <h2>提示词预览</h2>
        <button id="prompt-preview-close" class="close-btn">✕</button>
    </div>

    <div class="preview-content">
        <div class="preview-section">
            <h3>生成的正式提示词</h3>
            <textarea id="prompt-preview-textarea" class="prompt-preview-textarea" readonly></textarea>
        </div>

        <div class="preview-section">
            <h3>模块组织方式</h3>
            <div id="prompt-preview-structure" class="prompt-structure">
                <!-- 模块结构预览将动态生成 -->
            </div>
        </div>
    </div>

    <div class="window-actions">
        <button id="copy-prompt-btn" class="btn-primary">复制提示词</button>
        <button id="close-preview-btn" class="btn-secondary">关闭</button>
    </div>
</div>